<ion-view view-title="{{vm.pageTitle}}" ng-controller="eventEditorController as vm" hide-back-button="false">

    <ion-nav-buttons side="right">
        <button class="button button-royal logout-button"  ng-click="vm.saveModal()">
            <translate>Save</translate>
        </button>
    </ion-nav-buttons>

    <ion-content class="default-background"
                 delegate-handle="front-page-scroll">

        <div class="editor-modal-container">

            <div class="event-type-select" ng-show="vm.eventType === undefined">
                <label>How many surveys during the event?</label>
                <div class="button-bar">
                    <a class="button" ng-click="vm.chooseType(1)">One survey</a>
                    <a class="button" ng-click="vm.chooseType(3)">Three surveys</a>
                </div>
            </div>

            <div ng-show="vm.eventType !== undefined">
                <div class="editor-modal" ng-show="vm.eventType == 3">
                    <form class="editor-form">
                        <div class="row">
                            <div class="col">
                    <span class="editor-input-group event-name-input">
                        <input type="text" class="editor-input" placeholder="Event name"
                               required="required" ng-model="vm.event.name">
                        <div class="editor-input-bar"></div>
				    </span>

                                <div class="event-password-input">
                                    (<span class="editor-input-group">
                            <input type="text" class="editor-input" placeholder="{{'eventCode' | translate}}"
                                   required="required" autocapitalize="none" ng-model="vm.event.password">
                            <div class="editor-input-bar"></div>
				        </span>)
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="icon-col"><i class="icon ion-ios-calendar-outline padding-right"></i></div>
                            <div class="col">
                                <div class="editor-dates">
                        <span class="editor-input-group editor-date-input">
                            <input type="date" class="editor-input" required="required" placeholder="YYYY-MM-DD"
                                   ng-model="vm.event.startDate">
                            <div class="editor-input-bar"></div>
                        </span> &ndash;
                                    <span class="editor-input-group editor-date-input">
                            <input type="date" class="editor-input" required="required" placeholder="YYYY-MM-DD"
                                   ng-model="vm.event.endDate">
                            <div class="editor-input-bar"></div>
                        </span>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="icon-col"><i class="icon ion-ios-location padding-right"></i></div>
                            <div class="col">
                    <span class="editor-input-group">
                        <input type="text" class="editor-input" placeholder="{{'meetingPoint' | translate}}"
                               required="required" ng-model="vm.event.meetingPoint">
                        <div class="editor-input-bar"></div>
				    </span>
                            </div>
                        </div>
                        <div class="row">
                            <div class="icon-col"><i class="icon ion-ios-list-outline padding-right"></i></div>
                            <div class="col">
                                <label>{{'program' | translate}}:</label>
                                <span class="editor-input-group">
                        <textarea ng-model="vm.event.program" required="required"
                                  class="editor-program-input"></textarea>
                        <div class="editor-input-bar"></div>
                    </span>
                            </div>
                        </div>
                        <div class="row">
                            <div class="icon-col"><i class="icon ion-ios-information-outline padding-right"></i></div>
                            <div class="col">
                                <label>{{'bring' | translate}}:</label>
                                <span class="editor-input-group">
                        <input type="text" class="editor-input" placeholder="{{'bring' | translate}}"
                               required="required" ng-model="vm.event.bring">
                        <div class="editor-input-bar"></div>
				    </span>
                                <br>
                                <label>{{'moreInfo' | translate}}:</label>
                                <span class="editor-input-group">
                        <input type="text" class="editor-input" placeholder="{{'moreInfo' | translate}}"
                               required="required" ng-model="vm.event.otherInfo">
                        <div class="editor-input-bar"></div>
				    </span>

                            </div>
                        </div>

                        <div class="row">
                            <div class="icon-col"><i class="icon ion-clock padding-right"></i></div>
                            <div class="col">
                                <label>Survey opened:</label>
                                <div style="width: 100%" class="editor-open-times">
                                    Before:
                                    <div class="editor-dates">
                            <span class="editor-input-group editor-date-input">
                                <input type="datetime-local" class="editor-input" required="required"
                                       placeholder="YYYY-MM-DD HH:MM"
                                       ng-model="vm.moduleInfo.startTime1">
                                <div class="editor-input-bar"></div>
                            </span> &ndash;
                                        <span class="editor-input-group editor-date-input">
                                <input type="datetime-local" class="editor-input" required="required"
                                       placeholder="YYYY-MM-DD HH:MM"
                                       ng-model="vm.moduleInfo.endTime1">
                                <div class="editor-input-bar"></div>
                            </span>
                                    </div>
                                    During:
                                    <div class="editor-dates">
                            <span class="editor-input-group editor-date-input">
                                <input type="datetime-local" class="editor-input" required="required"
                                       placeholder="YYYY-MM-DD HH:MM"
                                       ng-model="vm.moduleInfo.startTime2">
                                <div class="editor-input-bar"></div>
                            </span> &ndash;
                                        <span class="editor-input-group editor-date-input">
                                <input type="datetime-local" class="editor-input" required="required"
                                       placeholder="YYYY-MM-DD HH:MM"
                                       ng-model="vm.moduleInfo.endTime2">
                                <div class="editor-input-bar"></div>
                            </span>
                                    </div>
                                    After:
                                    <div class="editor-dates">
                            <span class="editor-input-group editor-date-input">
                                <input type="datetime-local" class="editor-input" required="required"
                                       placeholder="YYYY-MM-DD HH:MM"
                                       ng-model="vm.moduleInfo.startTime3">
                                <div class="editor-input-bar"></div>
                            </span> &ndash;
                                        <span class="editor-input-group editor-date-input">
                                <input type="datetime-local" class="editor-input" required="required"
                                       placeholder="YYYY-MM-DD HH:MM"
                                       ng-model="vm.moduleInfo.endTime3">
                                <div class="editor-input-bar"></div>
                            </span>
                                    </div>

                                </div>

                            </div>
                        </div>
                    </form>
                </div>

                <div class="editor-modal" ng-show="vm.eventType == 1">
                    <form class="editor-form">
                        <div class="row">
                            <div class="col">
                    <span class="editor-input-group event-name-input">
                        <input type="text" class="editor-input" placeholder="Event name"
                               required="required" ng-model="vm.event.name">
                        <div class="editor-input-bar"></div>
				    </span>

                                <div class="event-password-input">
                                    (<span class="editor-input-group">
                            <input type="text" class="editor-input" placeholder="{{'eventCode' | translate}}"
                                   required="required" autocapitalize="none" ng-model="vm.event.password">
                            <div class="editor-input-bar"></div>
				        </span>)
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="icon-col"><i class="icon ion-ios-calendar-outline padding-right"></i></div>
                            <div class="col">
                                <div class="editor-dates">
                        <span class="editor-input-group editor-date-input">
                            <input type="date" class="editor-input" required="required" placeholder="YYYY-MM-DD"
                                   ng-model="vm.event.startDate">
                            <div class="editor-input-bar"></div>
                        </span> &ndash;
                                    <span class="editor-input-group editor-date-input">
                            <input type="date" class="editor-input" required="required" placeholder="YYYY-MM-DD"
                                   ng-model="vm.event.endDate">
                            <div class="editor-input-bar"></div>
                        </span>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="icon-col"><i class="icon ion-clock padding-right"></i></div>
                            <div class="col">
                                <label>Survey opened:</label>
                                <div class="editor-dates">
                        <span class="editor-input-group editor-date-input">
                            <input type="datetime-local" class="editor-input" required="required"
                                   placeholder="YYYY-MM-DD HH:MM"
                                   ng-model="vm.moduleInfo.startTime">
                            <div class="editor-input-bar"></div>
                        </span> &ndash;
                                    <span class="editor-input-group editor-date-input">
                            <input type="datetime-local" class="editor-input" required="required"
                                   placeholder="YYYY-MM-DD HH:MM"
                                   ng-model="vm.moduleInfo.endTime">
                            <div class="editor-input-bar"></div>
                        </span>

                                    <!--<div>
                            <ionic-timepicker input-obj="ts.timePickerObj">
                                <button class="button button-block button-stable button-border">
                                    <strong>{{vm.timePickerObj.displayValue()}}</strong>
                                </button>
                            </ionic-timepicker>
                        </div>
                        <div>
                            <ionic-datepicker input-obj="ts.datePickerObj">
                                <button class="button button-block button-stable button-border">
                                    <strong>{{vm.datePickerObj.inputDate | date:vm.dateFormat}}</strong>
                                </button>
                            </ionic-datepicker>
                        </div>-->
                                </div>
                            </div>
                        </div>
                    </form>
                </div>

                <button class="button button-royal" ng-click="vm.showQuestions()"
                        ng-class="{'button-outline': vm.questionsShow}"
                        ng-show="vm.pageTitle == 'Edit event'">
                    Show questions
                </button>
                <div class="editor-questions" ng-show="vm.questionsShow">
                    <form class="editor-form">
                        <div ng-repeat="module in vm.customModules" class="editor-module">
                            <div class="editor-module-name" ng-click="vm.showSteps(module.number)">
                                <span>{{module.number}})</span> {{module.name}}
                                <i class="caret rotate" ng-class="{'open':!!module.open}"></i>
                            </div>
                            <div class="editor-steps" ng-show="!!module.open">
                                <ol class="vertical-steps">
                                    <li ng-repeat-start="step in module.wizard.steps"
                                        class="list-group-item question editor-step" ng-class="{'new-step': step.new}">
                                        <div>
                                            <div ng-if="step.new">
                                                <select ng-model="vm.newStepType"
                                                        ng-options="type for type in vm.stepTypes"
                                                        ng-change="vm.newStepTypeSelected()" ></select>
                                            </div>

                                            <div ng-if="step.stepTemplate.url=='client/components/wizard/templates/slider.html'">
                                                <div class="editor-question">
                                                <span class="question">


                                                    <span class="editor-input-group">
                                                        <input type="text" ng-model="step.stepTemplate.config.question"
                                                               placeholder="Question" class="editor-input"
                                                               required="required">
                                                        <div class="editor-input-bar"></div>
                                                    </span>

                                                    <span class="mandatory" title="mandatory"
                                                          ng-if="step.stepTemplate.config.mandatory">*</span>
                                                </span>
                                                    <span class="property"
                                                          title="Abbreviation visible only in the Excel output">
                                                    ({{step.stepTemplate.config.propertyName}})
                                                </span>
                                                    <br>
                                                    <span class="type">Slider:</span>
                                                </div>
                                                <ul>
                                                    <li>
                                                        <i class="icon ion-sad-outline"></i>
                                                        <span class="editor-input-group">
                                                        <input type="number"
                                                               ng-model="step.stepTemplate.config.minValue"
                                                               placeholder="min value"
                                                               class="editor-input"
                                                               required="required">
                                                        <div class="editor-input-bar"></div>
                                                    </span>
                                                        :

                                                        <span class="editor-input-group">
                                                        <input type="text"
                                                               ng-model="step.stepTemplate.config.negativeText"
                                                               placeholder="negative text" class="editor-input"
                                                               required="required">
                                                        <div class="editor-input-bar"></div>
                                                    </span>

                                                    </li>
                                                    <li>
                                                        <i class="icon ion-happy-outline"></i>

                                                        <span class="editor-input-group">
                                                        <input type="number"
                                                               ng-model="step.stepTemplate.config.maxValue"
                                                               placeholder="max value"
                                                               class="editor-input"
                                                               ng-min="step.stepTemplate.config.minValue"
                                                               required="required">
                                                        <div class="editor-input-bar"></div>
                                                    </span>


                                                        :
                                                        <span class="editor-input-group">
                                                        <input type="text"
                                                               ng-model="step.stepTemplate.config.positiveText"
                                                               placeholder="positive text"
                                                               class="editor-input" required="required">
                                                        <div class="editor-input-bar"></div>
                                                    </span>

                                                    </li>
                                                </ul>
                                            </div>

                                            <div ng-if="step.stepTemplate.url=='client/components/wizard/templates/single-question.html'">
                                                <div class="editor-question">
                                                <span class="question">
                                                    <span class="editor-input-group">
                                                        <input type="text" ng-model="step.stepTemplate.config.question"
                                                               placeholder="Question" class="editor-input"
                                                               required="required">
                                                        <div class="editor-input-bar"></div>
                                                    </span>

                                                    <span class="mandatory" ng-if="step.stepTemplate.config.mandatory"
                                                          title="mandatory">*</span>

                                                </span>
                                                    <span class="property"
                                                          title="Abbreviation visible only in the Excel output">
                                                    ({{step.stepTemplate.config.propertyName}})
                                                </span>
                                                    <br>
                                                    <span class="type" ng-if="!step.stepTemplate.config.multipleChoice">Single choice:</span>
                                                    <span class="type" ng-if="step.stepTemplate.config.multipleChoice">Multiple choice:</span>
                                                </div>
                                                <ul>
                                                    <li ng-repeat="answer in step.stepTemplate.config.answers">{{answer}}</li>
                                                </ul>
                                            </div>

                                            <div ng-if="step.stepTemplate.url=='client/components/wizard/templates/multiple-questions.html'"
                                                 ng-repeat="question in step.stepTemplate.config.questions">
                                                <div class="editor-question">
                                                <span class="question">
                                                    <span class="editor-input-group">
                                                        <input type="text" ng-model="question.question"
                                                               placeholder="Question" class="editor-input"
                                                               required="required">
                                                        <div class="editor-input-bar"></div>
                                                    </span>

                                                    <span class="mandatory" ng-if="step.stepTemplate.config.mandatory"
                                                          title="mandatory">*</span>
                                                </span>
                                                    <span class="property"
                                                          title="Abbreviation visible only in the Excel output">
                                                    ({{question.propertyName}})
                                                </span>
                                                    <br>
                                                    <span class="type">Single choice:</span>
                                                </div>
                                                <ul>
                                                    <li ng-repeat="answer in question.answers">{{answer}}</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </li>
                                    <li ng-repeat-end
                                        ng-if="!step.new"
                                        class="list-group-item add editor-step"
                                        ng-click="vm.addStep(module._id, $index + 1)">
                                    </li>
                                </ol>
                                <hr>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>

    </ion-content>
</ion-view>

